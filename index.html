<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Chat | chat.joshghent.com</title>
    <meta charset="UTF-8">
    <link href="css/style.css" rel="stylesheet">
  </head>
  <body>
    <ul id="chat_log"></ul>
    <form action="" id="chat">
      <input id="message_text" /><button>Send</button>
    </form>
  </body>
  <script src="/socket.io/socket.io.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/push.js/0.0.9/push.min.js"></script>
  <script src="//code.jquery.com/jquery-2.2.0.min.js"></script>
  <script>

    $(document).ready(function(){
      $("<audio id='chatAudio'><source src='sound/ping.mp3' type='audio/mpeg'></audio>").appendTo('body');
    });

    var socket = io();

    $('form').submit(function(){
      socket.emit('chat message', $('#message_text').val());
      $('#chat_log').append($('<li>').text($('#message_text').val()));
      $('#message_text').val('');
      return false;
    });

    socket.on('chat message', function(message){
      $('#chat_log').append($('<li>').text(message));
      Push.create(message, { timeout: 5000});
      $('#chatAudio')[0].play();
    });

  </script>
</html>